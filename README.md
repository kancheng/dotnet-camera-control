# 相機應用程式 (CameraApp)

一個功能完整的 Windows 桌面應用程式，用於連接電腦攝像頭進行拍照和錄影，支援自訂設定和自動儲存功能。

## 📋 目錄

- [功能特色](#功能特色)
- [系統需求](#系統需求)
- [安裝說明](#安裝說明)
- [使用說明](#使用說明)
- [設定檔說明](#設定檔說明)
- [專案結構](#專案結構)
- [技術棧](#技術棧)
- [授權資訊](#授權資訊)

## ✨ 功能特色

### 核心功能

- **攝像頭連接與管理**
  - 自動偵測可用的攝像頭設備
  - 支援多個攝像頭選擇
  - 即時預覽畫面

- **拍照功能**
  - 支援延遲拍照（0-60 秒，0.5 秒間隔）
  - 倒數計時顯示
  - 自動儲存為 JPEG 格式

- **錄影功能**
  - 可設定錄影時長（1-300 秒）
  - 即時顯示剩餘錄影時間
  - 以連續截圖方式儲存（每秒 10 幀）

- **目錄管理**
  - 可自訂輸出目錄
  - 自動建立時間標籤目錄（格式：`yyyyMMdd_HHmmss`）
  - 自動處理重複目錄名稱（加上 `_1`, `_2`, `_3` 等後綴）

- **設定管理**
  - JSON 格式設定檔自動儲存
  - 應用程式啟動時自動載入設定
  - 設定變更時自動儲存

- **即時資訊顯示**
  - 顯示當前時間（每秒更新）
  - 顯示拍照/錄影倒數計時
  - 狀態訊息提示

## 💻 系統需求

- **作業系統**：Windows 10 或更高版本
- **.NET 執行環境**：.NET 8.0 Runtime
- **硬體需求**：
  - 至少一個可用的攝像頭設備
  - 建議 4GB RAM 以上

## 🚀 安裝說明

### 方法一：使用預編譯版本

1. 下載最新版本的 `CameraApp.exe`
2. 確保已安裝 .NET 8.0 Runtime
3. 直接執行 `CameraApp.exe`

### 方法二：從原始碼編譯

1. **克隆或下載專案**
   ```bash
   git clone <repository-url>
   cd cameracsharp
   ```

2. **還原 NuGet 套件**
   ```bash
   dotnet restore
   ```

3. **編譯專案**
   ```bash
   dotnet build
   ```

4. **執行應用程式**
   ```bash
   dotnet run
   ```

   或直接執行編譯後的執行檔：
   ```
   bin\Debug\net8.0-windows\CameraApp.exe
   ```

## 📖 使用說明

### 基本操作流程

1. **啟動應用程式**
   - 應用程式會自動偵測可用的攝像頭
   - 如果沒有偵測到攝像頭，會顯示警告訊息

2. **連接攝像頭**
   - 從下拉選單選擇要使用的攝像頭
   - 點擊「連接相機」按鈕
   - 連接成功後，預覽畫面會顯示攝像頭畫面

3. **設定參數**
   - **拍照延遲**：設定按下拍照按鈕後多久才拍照（秒）
   - **錄影時長**：設定錄影的持續時間（秒）
   - **輸出目錄**：點擊「選擇目錄」按鈕選擇檔案儲存位置

4. **拍照**
   - 設定好拍照延遲時間
   - 點擊「拍照」按鈕
   - 倒數計時會顯示剩餘時間
   - 照片會自動儲存到指定的目錄

5. **錄影**
   - 設定好錄影時長
   - 點擊「開始錄影」按鈕
   - 錄影過程中會顯示剩餘時間
   - 錄影完成後，所有幀會儲存到指定的目錄

6. **斷開連接**
   - 點擊「斷開連接」按鈕停止攝像頭

### 檔案儲存規則

- **目錄結構**：
  ```
  輸出目錄/
  └── yyyyMMdd_HHmmss/          (時間標籤目錄)
      ├── photo_yyyyMMdd_HHmmss.jpg
      └── video_yyyyMMdd_HHmmss_frame_000001.jpg
          └── video_yyyyMMdd_HHmmss_frame_000002.jpg
          └── ...
  ```

- **重複目錄處理**：
  - 如果同一秒內建立多個檔案，會自動加上後綴
  - 例如：`20240101_120000`, `20240101_120000_1`, `20240101_120000_2`

## ⚙️ 設定檔說明

應用程式會在執行檔同目錄下自動建立 `settings.json` 設定檔。

### 設定檔位置
```
CameraApp.exe 所在目錄/settings.json
```

### 設定檔格式
```json
{
  "OutputDirectory": "C:\\Users\\YourName\\Documents\\CameraApp",
  "CaptureDelay": 0.0,
  "RecordDuration": 10.0
}
```

### 設定項目說明

| 項目 | 說明 | 預設值 | 範圍 |
|------|------|--------|------|
| `OutputDirectory` | 輸出目錄路徑 | `我的文件\CameraApp` | 任何有效的目錄路徑 |
| `CaptureDelay` | 拍照延遲時間（秒） | 0.0 | 0.0 - 60.0 |
| `RecordDuration` | 錄影時長（秒） | 10.0 | 1.0 - 300.0 |

### 設定檔管理

- **自動載入**：應用程式啟動時自動讀取設定檔
- **自動儲存**：
  - 修改拍照延遲或錄影時長時自動儲存
  - 變更輸出目錄時自動儲存
  - 應用程式關閉時自動儲存所有設定
- **預設值**：如果設定檔不存在或損壞，會自動建立包含預設值的設定檔

## 📁 專案結構

```
cameracsharp/
├── Program.cs              # 應用程式入口點
├── MainForm.cs             # 主表單，包含所有 UI 和功能邏輯
├── AppSettings.cs          # 設定檔管理類別
├── CameraApp.csproj        # 專案設定檔
├── NuGet.config            # NuGet 套件來源設定
├── settings.json           # 應用程式設定檔（自動生成）
└── README.md               # 本檔案
```

## 🛠️ 技術棧

- **開發框架**：.NET 8.0
- **UI 框架**：Windows Forms
- **程式語言**：C#
- **主要套件**：
  - `AForge.Video` (2.2.5) - 視訊處理
  - `AForge.Video.DirectShow` (2.2.5) - DirectShow 視訊設備支援
  - `AForge.Imaging` (2.2.5) - 影像處理

## 📝 注意事項

1. **錄影功能**：
   - 目前錄影功能是以連續截圖方式實現（每秒 10 幀）
   - 檔案會儲存為多張 JPEG 圖片，而非單一影片檔案
   - 如需真正的影片檔案（AVI/MP4），需要整合 FFmpeg 或其他影片編碼庫

2. **攝像頭權限**：
   - 首次使用時，Windows 可能會要求授權攝像頭存取權限
   - 請確保已授予應用程式攝像頭存取權限

3. **設定檔**：
   - 設定檔使用 UTF-8 編碼
   - 建議不要手動編輯設定檔，以免造成格式錯誤
   - 如果設定檔損壞，應用程式會自動重建預設設定檔

## 🐛 常見問題

### Q: 無法偵測到攝像頭？
A: 
- 確認攝像頭已正確連接
- 檢查 Windows 裝置管理員中攝像頭是否正常運作
- 確認其他應用程式沒有獨占使用攝像頭

### Q: 錄影檔案在哪裡？
A: 
- 錄影檔案會儲存在您設定的輸出目錄中
- 每個錄影會建立一個時間標籤目錄
- 錄影的每一幀會儲存為獨立的 JPEG 檔案

### Q: 如何更改輸出目錄？
A: 
- 點擊介面上的「選擇目錄」按鈕
- 選擇新的目錄後，設定會自動儲存

### Q: 設定檔在哪裡？
A: 
- 設定檔位於應用程式執行檔（.exe）的同目錄下
- 檔案名稱：`settings.json`

## 📄 授權資訊

請參閱專案中的 `LICENSE` 檔案。

## 🤝 貢獻

歡迎提交 Issue 或 Pull Request 來改善這個專案。

## 📧 聯絡資訊

如有任何問題或建議，請透過 Issue 功能回報。

---

**版本**：1.0.0  
**最後更新**：2024
